<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard</title>
    <!-- Professional CSS for base.html, base1.html, admindashboard.html, adminlogin.html -->
<style>
    *{font-size:20px;}
    body {
        background: linear-gradient(135deg, #A97DC9 0%, #fff 100%);
        min-height: 100vh;
        margin: 0;
        font-family: 'Segoe UI', 'Roboto', 'Arial', sans-serif;
        color: #222;
    }
    .nav {
        background: #222;
        padding: 18px 0;
        border-radius: 0 0 18px 18px;
        box-shadow: 0 2px 8px rgba(169, 125, 201, 0.15);
        display: flex;
        justify-content: center;
        gap: 32px;
    }
    .nav a {
        color: #A97DC9;
        text-decoration: none;
        font-size: 1.3rem;
        font-weight: 600;
        padding: 8px 18px;
        border-radius: 8px;
        transition: background 0.2s, color 0.2s;
    }
    .nav a:hover {
        background: #A97DC9;
        color: #fff;
    }
    h1, h2 {
        color: #222;
        font-weight: 700;
        letter-spacing: 1px;
        margin-top: 32px;
        margin-bottom: 18px;
        text-align: center;
    }
    h2 {
        background: #A97DC9;
        color: #fff;
        border-radius: 18px;
        padding: 12px 0;
        width: 60%;
        margin: 32px auto 18px auto;
        box-shadow: 0 2px 8px rgba(169, 125, 201, 0.12);
    }
    form {
        background: #fff;
        padding: 32px 28px;
        border-radius: 18px;
        box-shadow: 0 2px 16px rgba(169, 125, 201, 0.13);
        max-width: 500px;
        margin: 32px auto;
        display: flex;
        flex-direction: column;
        gap: 18px;
    }
    input[type="text"], input[type="date"], input[type="email"], input[type="password"], textarea, select {
        border: 1.5px solid #A97DC9;
        border-radius: 8px;
        padding: 12px;
        font-size: 1.1rem;
        background: #f7f4fa;
        transition: border 0.2s;
        outline: none;
    }
    input[type="text"]:focus, input[type="date"] ,input[type="email"]:focus, input[type="password"]:focus, textarea:focus, select:focus {
        border-color: #222;
    }
    button, input[type="submit"] {
        background: #A97DC9;
        color: #fff;
        font-size: 1.2rem;
        font-weight: 600;
        border: none;
        border-radius: 8px;
        padding: 12px 0;
        cursor: pointer;
        transition: background 0.2s;
        margin-top: 8px;
    }
    button:hover, input[type="submit"]:hover {
        background: #222;
        color: #A97DC9;
    }
    table {
        width: 95%;
        margin: 32px auto;
        border-collapse: collapse;
        background: #fff;
        border-radius: 18px;
        box-shadow: 0 2px 16px rgba(169, 125, 201, 0.13);
        overflow: hidden;
    }
    th, td {
        padding: 16px 12px;
        border-bottom: 1px solid #eee;
        text-align: left;
        font-size: 1.05rem;
    }
    th {
        background: #A97DC9;
        color: #fff;
        font-weight: 600;
        border-bottom: 2px solid #fff;
    }
    tr:last-child td {
        border-bottom: none;
    }
    a.delete-link {
        color: #fff;
        background: #e74c3c;
        padding: 6px 14px;
        border-radius: 6px;
        text-decoration: none;
        font-weight: 600;
        transition: background 0.2s;
    }
    a.delete-link:hover {
        background: #c0392b;
    }
    .msg-success {
        color: #A97DC9;
        font-size: 1.2rem;
        text-align: center;
        margin-top: 18px;
        font-weight: 500;
    }
    @media (max-width: 700px) {
        .nav { flex-direction: column; gap: 12px; }
        h2 { width: 90%; font-size: 1.2rem; }
        table, form { width: 98%; }
        th, td { font-size: 0.95rem; padding: 8px 6px; }
    }
.reset-link {
    background: #A97DC9;
    color: #fff;
    font-size: 1.2rem;
    font-weight: 600;
    border: none;
    border-radius: 8px;
    padding: 12px 0;
    cursor: pointer;
    transition: background 0.2s, color 0.2s;
    margin-left: 10px;
    width: 120px;
    display: inline-block;
    text-align: center;
    text-decoration: none;
}

.reset-link:hover {
    background: #222;
    color: #A97DC9;
    text-decoration: none;
}

</style>
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
</head>
<body>
<center>
<div class="nav">
	{%  if user.is_authenticated  %}
	<a href="{%   url  'adminlogout'   %}"> Logout </a>
	<a href="{%   url  'admincp'   %}"> Change Password </a>
	<a href="{%   url  'manage_menu'   %}"> Manage Menu </a>
	<a href="{% url 'aboutus' %}">About Us</a>
	{% else  %}
	<a href="{%   url  'adminlogin'   %}"> Admin Login </a>
	<a href="{% url 'aboutus' %}">About Us</a>
  
	{%  endif%}

</div>
    <h2 style="text-align:center;color:black">Admin Dashboard - All Orders</h2>

<form method="get" style="text-align:center; margin-bottom: 20px;">
    <input type="text" name="q" placeholder="Search Name or Order ID" value="{{ q }}" style="padding: 5px;">
    
    <select name="payment" style="padding: 5px;">
        <option value="">--Payment Status--</option>
        <option value="Paid" {% if payment == "Paid" %}selected{% endif %}>Paid</option>
        <option value="Not Paid" {% if payment == "Not Paid" %}selected{% endif %}>Not Paid</option>
    </select>

    <input type="text" name="place" placeholder="Order Place (Ex. OPD)" value="{{ place }}" style="padding: 5px;">
    <input type="date" name="date" value="{{ date }}">
    <button type="submit" style="padding: 5px 10px;">Search</button>
    <a href="{% url 'admindashboard' %}" class="reset-link" style="margin-left:10px; color:white;">Reset</a>
</form>

    <table>
        <thead>
            <tr>
                <th style="text-align:center;color:black">Order ID</th>
		<th style="text-align:center;color:black">User_Id</th>
                <th style="text-align:center;color:black">Name</th>
                <th style="text-align:center;color:black">Surname</th>
                <th style="text-align:center;color:black">Order_Menu</th>
                <th style="text-align:center;color:black">Order_place</th>
                <th style="text-align:center;color:black">Paymnt Status</th>
                <th style="text-align:center;color:black">Date & Time</th>
		<th style="text-align:center;color:black">Price</th>
		<th style="text-align:center;color:black">Delete</th>
	
            </tr>
        </thead>
        <tbody>
            {% for order in orders %}
                <tr>
                    <td>{{ order.order_id }}</td>
		    <td>{{ order.user_id }}</td>
                    <td>{{ order.name }}</td>
                    <td>{{ order.surname }}</td> 
                    <td>
    {% for item, qty in order.order_menu_list %}
        {{ item }}: {{ qty }}<br>
    {% endfor %}
                    </td>

 
                    <td>{{ order.order_place }}</td>
                    <td>{{ order.is_paid}}</td>
                    <td>{{ order.order_time }}</td>
		    <td>â‚¹{{ order.total_price }}</td>
<td>
    <a href="{% url 'delete_order' order.order_id %}" class="delete-link" onclick="return confirm('Are you sure you want to delete this order?');">Delete</a>

</td>




                </tr>
            {% empty %}
                <tr><td colspan="9" style="text-align:center;">No orders placed yet.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</center>
<script>
let isNavigatingInternally = false;

// Mark internal links (buttons or anchors that keep you on same site)
document.querySelectorAll("a, button").forEach((el) => {
    el.addEventListener("click", () => {
        isNavigatingInternally = true;
    });
});

window.addEventListener("beforeunload", function (e) {
    if (!isNavigatingInternally) {
        navigator.sendBeacon("/auto_admin_logout");
    }
});
</script>


</body>
</html>
